# ip = [[0.00020074844360351562, 2.0194053649902344e-05, 3.516674041748047e-05, 4.6825408935546876e-05, 4.751682281494141e-05, 5.319118499755859e-05, 7.510185241699219e-05, 9.450912475585937e-05, 0.00013124942779541016, 0.00024347305297851564, 0.00046296119689941405, 0.0010372400283813477, 0.002347421646118164, 0.005351829528808594], [2.6416778564453124e-05, 2.5796890258789063e-05, 5.071163177490234e-05, 5.218982696533203e-05, 5.9270858764648436e-05, 7.207393646240235e-05, 0.00010933876037597657, 0.0001565694808959961, 0.0004741907119750977, 0.0004904508590698242, 0.000966191291809082, 0.0020594120025634764, 0.004394745826721192, 0.0101531982421875], [3.1948089599609375e-05, 2.9969215393066407e-05, 5.693435668945313e-05, 6.437301635742188e-05, 7.753372192382812e-05, 0.00010442733764648438, 0.00016460418701171874, 0.0002669095993041992, 0.0004896402359008789, 0.0010716915130615234, 0.00221710205078125, 0.004045605659484863, 0.007705807685852051, 0.020586943626403807], [3.807544708251953e-05, 3.960132598876953e-05, 7.636547088623047e-05, 9.164810180664062e-05, 0.0001235485076904297, 0.00019998550415039061, 0.0003180503845214844, 0.0005651712417602539, 0.001062488555908203, 0.0020920991897583007, 0.004229116439819336, 0.008565521240234375, 0.017940664291381837, 0.03929932117462158], [0.0002787590026855469, 5.939006805419922e-05, 0.00011014938354492188, 0.00015556812286376953, 0.0002348184585571289, 0.00042319297790527344, 0.0007515192031860351, 0.0014140844345092774, 0.002717280387878418, 0.00587310791015625, 0.010950660705566407, 0.022332024574279786, 0.04443495273590088, 0.09257466793060302], [0.00011756420135498047, 0.00010159015655517579, 0.0001953125, 0.00031387805938720703, 0.0005505084991455078, 0.0009469747543334961, 0.002580547332763672, 0.003511190414428711, 0.006996870040893555, 0.013364553451538086, 0.026594114303588868, 0.05433971881866455, 0.1066082239151001, 0.22285499572753906], [0.00014803409576416015, 0.00018646717071533204, 0.0005070924758911133, 0.0008823394775390625, 0.0016522407531738281, 0.003141045570373535, 0.0059688806533813475, 0.013267254829406739, 0.023733878135681154, 0.047552752494812014, 0.0933607816696167, 0.18727388381958007, 0.3730855226516724, 0.7539227724075317], [0.00030939579010009767, 0.000397491455078125, 0.0010879993438720702, 0.00214688777923584, 0.0035700321197509764, 0.007349872589111328, 0.015172886848449706, 0.02641186714172363, 0.05287196636199951, 0.10579144954681396, 0.21169395446777345, 0.4317906856536865, 0.8483991146087646, 1.6898659944534302], [0.0005834579467773437, 0.0020331621170043947, 0.0023111820220947264, 0.004157018661499023, 0.007838559150695801, 0.015085482597351074, 0.03134446144104004, 0.05919923782348633, 0.11880412101745605, 0.2303696393966675, 0.44298222064971926, 0.8724705696105957, 1.7060075521469116, 3.3688987255096436], [0.0011229515075683594, 0.0015703201293945312, 0.004988527297973633, 0.00900282859802246, 0.01731595993041992, 0.033507895469665525, 0.06617748737335205, 0.1326082944869995, 0.2460402011871338, 0.4487483501434326, 0.8560632467269897, 1.6576577425003052, 3.2906859636306764, 6.5040781736373905], [0.0025790929794311523, 0.003498387336730957, 0.011108994483947754, 0.020044732093811034, 0.03932209014892578, 0.07320253849029541, 0.14704291820526122, 0.26392307281494143, 0.4857372522354126, 0.9058714151382447, 1.7389625787734986, 3.3923693180084227, 6.68178071975708, 13.357514882087708], [0.004971647262573242, 0.008334207534790038, 0.02424333095550537, 0.04337599277496338, 0.08347578048706054, 0.1674274444580078, 0.2825942039489746, 0.5188276529312134, 0.9845016241073609, 1.9090431928634644, 3.6460152864456177, 7.163071727752685, 14.165919756889343, 28.160752248764037], [0.017842578887939452, 0.023014593124389648, 0.05797712802886963, 0.10400171279907226, 0.18171541690826415, 0.3105076551437378, 0.5684525012969971, 1.064187264442444, 2.0672496795654296, 4.016211128234863, 7.751058554649353, 15.210141921043396, 30.160672521591188, 60.020645403862], [0.043966126441955564, 0.05449621677398682, 0.13628623485565186, 0.21797783374786378, 0.3552005529403687, 0.626446533203125, 1.1621910810470581, 2.2406304836273194, 4.341600823402405, 8.537417149543762, 16.536111545562743, 32.568813633918765, 64.60929048061371, 128.57673947811128]]

# lsh = [[0.007284331321716309, 0.003172898292541504, 0.0032057762145996094, 0.003953456878662109, 0.0034095287322998048, 0.003761553764343262, 0.003881978988647461, 0.004608559608459473, 0.006309604644775391, 0.009046554565429688, 0.01636981964111328, 0.026682376861572266, 0.055696296691894534, 0.11192874908447266], [0.003179335594177246, 0.0030998945236206054, 0.0031871795654296875, 0.003190946578979492, 0.0038484573364257813, 0.003565859794616699, 0.0039052963256835938, 0.004803919792175293, 0.0060089111328125, 0.010870075225830078, 0.0148301362991333, 0.02685115337371826, 0.0577178955078125, 0.11419329643249512], [0.0051661252975463865, 0.0031940221786499025, 0.0034406900405883787, 0.003383326530456543, 0.0033674001693725585, 0.004140448570251465, 0.004106259346008301, 0.004701733589172363, 0.00617828369140625, 0.009262895584106446, 0.016088271141052247, 0.0274259090423584, 0.05754311084747314, 0.11586105823516846], [0.003260087966918945, 0.003186655044555664, 0.003269600868225098, 0.003371143341064453, 0.003564596176147461, 0.0036430597305297852, 0.0058194160461425785, 0.00490419864654541, 0.006350994110107422, 0.009668278694152831, 0.01629929542541504, 0.03028841018676758, 0.06073107719421387, 0.12500369548797607], [0.003344225883483887, 0.003366684913635254, 0.0034047603607177735, 0.003486895561218262, 0.0035793066024780275, 0.0038176774978637695, 0.004423761367797851, 0.005217194557189941, 0.007034111022949219, 0.012217855453491211, 0.01826660633087158, 0.03316786289215088, 0.07000374794006348, 0.13798553943634034], [0.003840947151184082, 0.0035765886306762694, 0.0036197662353515624, 0.004257011413574219, 0.0038335561752319337, 0.004156970977783203, 0.006631731986999512, 0.005958199501037598, 0.009309911727905273, 0.013332939147949219, 0.02405581474304199, 0.04332878589630127, 0.08816986083984375, 0.18145377635955812], [0.003928136825561523, 0.003951358795166016, 0.004764080047607422, 0.004093551635742187, 0.004362058639526367, 0.004847836494445801, 0.005763936042785645, 0.007724666595458984, 0.011339926719665527, 0.02141835689544678, 0.03510270118713379, 0.06577255725860595, 0.1325995445251465, 0.262926721572876], [0.004655241966247559, 0.0047692060470581055, 0.0047751665115356445, 0.004973554611206054, 0.005405020713806152, 0.006368231773376465, 0.008294081687927246, 0.01123826503753662, 0.01933465003967285, 0.031874465942382815, 0.06019303798675537, 0.11529338359832764, 0.23291451930999757, 0.4541802883148193], [0.006164956092834473, 0.0063636541366577145, 0.006414794921875, 0.007056832313537598, 0.007635855674743652, 0.009268999099731445, 0.012522006034851074, 0.01844000816345215, 0.03397777080535889, 0.05756478309631348, 0.11016695499420166, 0.21844375133514404, 0.4302224636077881, 0.8508402347564697], [0.009261655807495116, 0.009513664245605468, 0.010559964179992675, 0.010697293281555175, 0.01249997615814209, 0.015525388717651366, 0.02318711280822754, 0.036411714553833005, 0.06234352588653565, 0.11627058982849121, 0.22433207035064698, 0.43830718994140627, 0.8684757232666016, 1.7130263328552247], [0.015378069877624512, 0.015923237800598143, 0.016668486595153808, 0.018367409706115723, 0.022422099113464357, 0.028185534477233886, 0.04440436363220215, 0.07196607589721679, 0.1250142812728882, 0.23529915809631347, 0.45999271869659425, 0.9114237070083618, 1.7913861989974975, 3.5586160898208616], [0.02730073928833008, 0.029172945022583007, 0.029923295974731444, 0.033710050582885745, 0.04094157218933105, 0.05731856822967529, 0.0845552921295166, 0.142370343208313, 0.26022346019744874, 0.49624526500701904, 0.9552607536315918, 1.8912864446640014, 3.7443981647491453, 7.4206424951553345], [0.05487189292907715, 0.05722732543945312, 0.06009759902954102, 0.06868565082550049, 0.08259792327880859, 0.11819694042205811, 0.17742249965667725, 0.30312299728393555, 0.548337721824646, 1.041978907585144, 2.0214799880981444, 3.9549839973449705, 7.869616198539734, 15.605997681617737], [0.11619026660919189, 0.12316052913665772, 0.1317049264907837, 0.14558758735656738, 0.17756836414337157, 0.24187211990356444, 0.3703547477722168, 0.625511360168457, 1.1460700035095215, 2.1866691589355467, 4.229279303550721, 8.333136677742004, 16.522731041908266, 32.84478507041931]]

import matplotlib.pyplot as plt
import numpy as np

import matplotlib
import matplotlib as mpl
from batch_size_256_bits_1_5_k_similar_0_2 import ip, lsh

# plt.rcParams['text.usetex'] = True

ip = np.array(ip)
lsh = np.array(lsh)

data = ((ip-lsh))*1000
vmax = np.max(np.abs(data))
vmin = -vmax

sizes = [8, 16, 32, 64, 128, 256, 512, 1024, 2048, 4096, 8192, 16384, 32768, 65536]

fig, ax = plt.subplots()
im = ax.imshow(np.cbrt(np.cbrt(data)), cmap='RdBu', vmin=np.cbrt(np.cbrt(vmin)), vmax=np.cbrt(np.cbrt(vmax)))

# Show all ticks and label them with the respective list entries
ax.set_xticks(np.arange(len(sizes)), labels=map(str, sizes), fontsize=8)
ax.set_yticks(np.arange(len(sizes)), labels=map(str, sizes), fontsize=8)

# Rotate the tick labels and set their alignment.
plt.setp(ax.get_xticklabels(), rotation=45, ha="right", rotation_mode="anchor", fontsize=5)

plt.tick_params(top=True, bottom=False,
                   labeltop=True, labelbottom=False)

# Loop over data dimensions and create text annotations.
for i in range(len(sizes)):
    for j in range(len(sizes)):
        text = ax.text(j, i, f"{data[i, j]:.1f}", ha="center", va="center", color="black", size='smaller', rotation=45)

ax.set_title(r"Time $IndexFlatIP-IndexLSH$ (ms)", pad=20)
ax.set_xlabel('size of searched vectors')
ax.xaxis.set_label_position('top') 
ax.set_ylabel('size of index vectors')
fig.tight_layout()
plt.show()


